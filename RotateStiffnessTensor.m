function T=RotateStiffnessTensor(R,C)
% rotation of stiffness tensor written in Voigt notation
% r - rotation matrix 3x3
% C - stiffness tensor 6x6

M=[R(1,1)^2      R(1,2)^2      R(1,3)^2      2*R(1,2)*R(1,3)             2*R(1,1)*R(1,3)             2*R(1,1)*R(1,2);
   R(2,1)^2      R(2,2)^2      R(2,3)^2      2*R(2,2)*R(2,3)             2*R(2,1)*R(2,3)             2*R(2,1)*R(2,2);
   R(3,1)^2      R(3,2)^2      R(3,3)^2      2*R(3,2)*R(3,3)             2*R(3,1)*R(3,3)             2*R(3,1)*R(3,2);
   R(2,1)*R(3,1) R(2,2)*R(3,2) R(2,3)*R(3,3) R(2,2)*R(3,3)+R(2,3)*R(3,2) R(2,1)*R(3,3)+R(2,3)*R(3,1) R(2,1)*R(3,2)+R(2,2)*R(3,2);
   R(1,1)*R(3,1) R(1,2)*R(3,2) R(1,3)*R(3,3) R(3,2)*R(3,3)+R(1,3)*R(3,2) R(1,1)*R(3,3)+R(1,3)*R(3,1) R(1,1)*R(3,2)+R(1,2)*R(3,2);
   R(1,1)*R(2,1) R(1,2)*R(2,2) R(1,3)*R(2,3) R(1,2)*R(2,3)+R(1,3)*R(2,2) R(1,1)*R(2,3)+R(1,3)*R(2,1) R(1,1)*R(2,2)+R(1,2)*R(2,2)];

% Tsig=[R(1,1)^2      R(2,1)^2      R(3,1)^2      2*R(1,1)*R(2,1)             2*R(2,1)*R(3,1)             2*R(3,1)*R(1,1);
%    R(1,2)^2      R(2,2)^2      R(3,2)^2      2*R(1,2)*R(2,2)             2*R(2,2)*R(3,2)             2*R(3,2)*R(1,2);
%    R(1,3)^2      R(2,3)^2      R(3,3)^2      2*R(1,3)*R(2,3)             2*R(2,3)*R(3,3)             2*R(3,3)*R(1,3);
%    R(1,1)*R(1,2) R(2,1)*R(2,2) R(3,1)*R(3,2) R(1,1)*R(2,2)+R(1,2)*R(2,1) R(2,1)*R(3,2)+R(3,1)*R(2,2) R(3,1)*R(1,2)+R(3,2)*R(1,1);
%    R(1,2)*R(1,3) R(2,2)*R(2,3) R(3,3)*R(3,2) R(2,3)*R(1,2)+R(1,3)*R(2,2) R(2,2)*R(3,3)+R(3,2)*R(2,3) R(3,2)*R(1,3)+R(1,2)*R(3,3);
%    R(1,1)*R(1,3) R(2,3)*R(2,1) R(3,3)*R(3,1) R(1,3)*R(2,1)+R(1,1)*R(2,3) R(2,3)*R(3,1)+R(2,1)*R(3,3) R(3,3)*R(1,1)+R(3,1)*R(1,3)];
% 
% Teps=[R(1,1)^2      R(2,1)^2      R(3,1)^2      R(1,1)*R(2,1)             R(2,1)*R(3,1)             R(3,1)*R(1,1);
%    R(1,2)^2      R(2,2)^2      R(3,2)^2      R(1,2)*R(2,2)             R(2,2)*R(3,2)             R(3,2)*R(1,2);
%    R(1,3)^2      R(2,3)^2      R(3,3)^2      R(1,3)*R(2,3)             R(2,3)*R(3,3)             R(3,3)*R(1,3);
%    2*R(1,1)*R(1,2) 2*R(2,1)*R(2,2) 2*R(3,1)*R(3,2) R(1,1)*R(2,2)+R(1,2)*R(2,1) R(2,1)*R(3,2)+R(3,1)*R(2,2) R(3,1)*R(1,2)+R(3,2)*R(1,1);
%    2*R(1,2)*R(1,3) 2*R(2,2)*R(2,3) 2*R(3,3)*R(3,2) R(2,3)*R(1,2)+R(1,3)*R(2,2) R(2,2)*R(3,3)+R(3,2)*R(2,3) R(3,2)*R(1,3)+R(1,2)*R(3,3);
%    2*R(1,1)*R(1,3) 2*R(2,3)*R(2,1) 2*R(3,3)*R(3,1) R(1,3)*R(2,1)+R(1,1)*R(2,3) R(2,3)*R(3,1)+R(2,1)*R(3,3) R(3,3)*R(1,1)+R(3,1)*R(1,3)];

T=M*C*M';

% T=Tsig*C*inv(Tsig);

